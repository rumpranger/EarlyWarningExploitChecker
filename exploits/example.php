<?php
use Exploit\PageRequest;
use Exploit\ExploitChecker;
$eol = "<br />";
if (php_sapi_name() == "cli")
{
	$eol = "\n";
}

$urls = array(
			'http://www.github.com/' => '','http://www.bing.com' => '', 'http://www.google.com/404' => '', 'httpthub' => '','http://www.yahoo.com' => '', 'http://plan.com/' => '102,106', 
		);

//$skip = array(202);
foreach ($urls as $url => $skip)
{
	$page = new PageRequest($url, $skip);

	echo $eol . 'Processing: ' . $url . $eol;
	$checker = new ExploitChecker();
	$result = $checker->processUrl($page);
	if ($result == true)
	{
		//var_dump($checker->getErrors());
		foreach ($checker->getErrors() as $error)
		{
			echo ' - #' . $error->code . ' - ' . $error->message . $eol;
		}
	}
	else
	{
		echo ' - No exploits found' . $eol;
	}
}
echo 'End of script' . $eol;

/**
 * Simple auto loader
 * @param unknown $name
 */
function __autoload($name)
{
	$parts = explode('\\', $name);
	require_once realpath(dirname(__FILE__)) . '/' . end($parts) . '.php';
}
// End of Script
